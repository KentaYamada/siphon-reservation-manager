<form v-if="!!reservation">
    <div class="field">
        <label class="label">予約日</label>
        <b-select placeholder="予約日を選択してください"
                  v-model="reservation.reservation_date_id"
                  @input="handleUpdateReservationDate($event)">
            <option v-for="d in businessDays" :key="d.id" :value="d.id">
                {{ d.business_date | formatDateJp }}
            </option>
        </b-select>
        <div v-if="$v.reservation.reservation_date.$error">
            <small class="help is-danger" v-if="!$v.reservation.reservation_date.required">
                予約日を選択してください。
            </small>
        </div>
    </div>
    <div class="field">
        <label class="label">予約時間</label>
        <b-select placeholder="予約時間を選択してください"
                  v-model="reservation.reservation_time_id"
                  @input="handleUpdateReservationTimezone($event)">
            <option v-for="t in timezones" :key="t.id" :value="t.id">
                {{ t.start_time | timePeriod(t.end_time) }}
            </option>
        </b-select>
        <div v-if="$v.reservation.reservation_start_time.$error">
            <small class="help is-danger" v-if="!$v.reservation.reservation_start_time.required">
                予約時間を選択してください。
            </small>
        </div>
    </div>
    <div class="field">
        <label class="label">空席状況</label>
        <selectable-reservation-seat-list
            :searchParams="searchParams"
            @update-is-all-reserved-seats="handleUpdateIsAllReservedSeats"
            @update-seat="handleUpdateSeat">
        </selectable-reservation-seat-list>
    </div>
    <div class="field">
        <label class="label">予約人数</label>
        <div class="control">
            <input type="number"
                   class="input has-text-right"
                   v-model.number="reservation.number_of_reservations"
                   :class="{ 'is-danger': $v.reservation.number_of_reservations.$error }">
            <div v-if="$v.reservation.number_of_reservations.$error">
                <small class="help is-danger" v-if="!$v.reservation.number_of_reservations.required">
                    予約人数を入力してください。
                </small>
            </div>
        </div>
    </div>
    <div class="field">
        <label class="label">お名前</label>
        <div class="control">
            <input type="text"
                   class="input"
                   placeholder="Gamoyon 花子"
                   v-model.trim="reservation.reserver_name"
                   :class="{ 'is-danger': $v.reservation.reserver_name.$error }">
            <div v-if="$v.reservation.reserver_name.$error">
                <small class="help is-danger" v-if="!$v.reservation.reserver_name.required">
                    名前を入力してください。
                </small>
            </div>
        </div>
    </div>
    <div class="field">
        <label class="label">電話番号 (ハイフンなし)</label>
        <div class="control">
            <input type="tel"
                   class="input"
                   placeholder="09012345678"
                   v-model.trim="reservation.tel"
                   :class="{ 'is-danger': $v.reservation.tel.$error }">
            <div v-if="$v.reservation.tel.$error">
                <small class="help is-danger" v-if="!$v.reservation.tel.required">
                    電話番号を入力してください。
                </small>
                <small class="help is-danger" v-if="!$v.reservation.tel.tel">
                    電話番号は半角数字で入力してください。
                </small>
            </div>
        </div>
    </div>
    <div class="field">
        <label class="label">
            メールアドレス
        </label>
        <div class="control">
            <input type="mail"
                   class="input"
                   placeholder="sweets.sukiko@email.com"
                   v-model.trim="reservation.mail"
                   :class="{ 'is-danger': $v.reservation.mail.$error }">
            <small>※入力したメールアドレスにお間違いがないか確認してください。</small>
            <div v-if="$v.reservation.mail.$error">
                <small class="help is-danger" v-if="!$v.reservation.mail.required">
                    メールアドレスを入力してください。
                </small>
                <small class="help is-danger"  v-if="!$v.reservation.mail.email">
                    メールアドレスの形式で入力してください(例: sweets.sukiko@email.com)。
                </small>
            </div>
        </div>
    </div>
    <div class="field">
        <label class="label">備考</label>
        <textarea class="textarea" placeholder="お店への伝達事項などあれば記入してください(例: 卵アレルギーがあります)" v-model="reservation.comment"></textarea>
    </div>
    <div class="form-actions has-text-right">
        <button type="button" class="button is-info" :disabled="disableSave" @click="handleSave()">
            <i class="fas fa-calendar-check"></i>
            {{ buttonText }}
        </button>
    </div>
</form>
